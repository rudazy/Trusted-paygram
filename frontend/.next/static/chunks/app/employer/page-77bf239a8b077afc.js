(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[114],{4416:function(e,t,s){Promise.resolve().then(s.bind(s,7152))},7152:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var l=s(7437),a=s(3478),r=s(8355),d=s(2265);function i(){let{payGramCore:e,address:t,encrypt:s,contractsReady:r}=(0,a.$)(),[i,n]=(0,d.useState)(""),[c,o]=(0,d.useState)(""),[m,x]=(0,d.useState)(""),[u,h]=(0,d.useState)(!1),[p,b]=(0,d.useState)(null);async function y(l){if(l.preventDefault(),e&&t){h(!0),b(null);try{let l=parseInt(c,10);if(isNaN(l)||l<=0)throw Error("Salary must be a positive number");let a=await e.getAddress(),r=await s(l,a,t);if(r.encrypted&&r.handles&&r.inputProof){let t=await e.addEmployee(i,r.handles[0],r.inputProof,m);await t.wait()}else{let t=await e.addEmployeePlaintext(i,l,m);await t.wait()}b({type:"success",message:"Employee added successfully"}),n(""),o(""),x("")}catch(e){b({type:"error",message:e instanceof Error?e.message:"Failed to add employee"})}finally{h(!1)}}}return(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/50 p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Add Employee"}),(0,l.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"emp-wallet",className:"block text-sm text-slate-400 mb-1",children:"Wallet Address"}),(0,l.jsx)("input",{id:"emp-wallet",type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"0x...",required:!0,className:"w-full px-3 py-2 rounded-lg bg-slate-800 border border-slate-700 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-emerald-600 transition-colors"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"emp-salary",className:"block text-sm text-slate-400 mb-1",children:"Salary (cPAY)"}),(0,l.jsx)("input",{id:"emp-salary",type:"number",value:c,onChange:e=>o(e.target.value),placeholder:"5000",min:"1",required:!0,className:"w-full px-3 py-2 rounded-lg bg-slate-800 border border-slate-700 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-emerald-600 transition-colors"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"emp-role",className:"block text-sm text-slate-400 mb-1",children:"Role"}),(0,l.jsx)("input",{id:"emp-role",type:"text",value:m,onChange:e=>x(e.target.value),placeholder:"Engineer",required:!0,className:"w-full px-3 py-2 rounded-lg bg-slate-800 border border-slate-700 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-emerald-600 transition-colors"})]}),(0,l.jsx)("button",{type:"submit",disabled:u||!r,className:"w-full px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:cursor-not-allowed text-white text-sm font-medium transition-colors",children:u?"Encrypting & Submitting...":"Add Employee (Encrypted)"}),p&&(0,l.jsx)("p",{className:"text-sm ".concat("success"===p.type?"text-emerald-400":"text-red-400"),children:p.message})]})]})}function n(){let{payGramCore:e,contractsReady:t}=(0,a.$)(),[s,i]=(0,d.useState)([]),[n,c]=(0,d.useState)(!1),o=(0,d.useCallback)(async()=>{if(e){c(!0);try{let t=await e.getEmployeeList(),s=[];for(let l of t)try{let t=await e.getEmployee(l);s.push({wallet:t.empWallet,isActive:t.isActive,hireDate:t.hireDate,lastPayDate:t.lastPayDate,role:t.role})}catch(e){}i(s)}catch(e){}finally{c(!1)}}},[e]);return(0,d.useEffect)(()=>{t&&o()},[t,o]),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/50 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Employee Roster"}),(0,l.jsx)("button",{onClick:o,disabled:n||!t,className:"px-3 py-1 rounded-lg bg-slate-800 hover:bg-slate-700 disabled:opacity-50 text-slate-300 text-xs font-medium border border-slate-700 transition-colors",children:n?"Loading...":"Refresh"})]}),t?0===s.length?(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No employees registered yet"}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-left text-slate-500 border-b border-slate-800",children:[(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Address"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Role"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Status"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Hire Date"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Last Paid"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-800/50",children:s.map(e=>(0,l.jsxs)("tr",{className:"text-slate-300",children:[(0,l.jsx)("td",{className:"py-3 font-mono text-xs",children:(0,r.FP)(e.wallet)}),(0,l.jsx)("td",{className:"py-3",children:e.role}),(0,l.jsx)("td",{className:"py-3",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(e.isActive?"bg-emerald-900/50 text-emerald-400":"bg-red-900/50 text-red-400"),children:e.isActive?"Active":"Inactive"})}),(0,l.jsx)("td",{className:"py-3 text-xs text-slate-400",children:(0,r.i$)(e.hireDate)}),(0,l.jsx)("td",{className:"py-3 text-xs text-slate-400",children:(0,r.i$)(e.lastPayDate)})]},e.wallet))})]})}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Connect wallet to view employees"})]})}function c(){let{payGramCore:e,contractsReady:t}=(0,a.$)(),[s,r]=(0,d.useState)(0),[i,n]=(0,d.useState)(0),[c,o]=(0,d.useState)(!1),[m,x]=(0,d.useState)(!1),[u,h]=(0,d.useState)(null),p=(0,d.useCallback)(async()=>{if(e)try{let t=await e.activeEmployeeCount();r(Number(t));let s=await e.totalPayrollsExecuted();n(Number(s))}catch(e){}},[e]);async function b(){if(e){o(!0),x(!1),h(null);try{let t=await e.executePayroll();await t.wait(),h({type:"success",message:"Payroll executed successfully"}),p()}catch(e){h({type:"error",message:e instanceof Error?e.message:"Failed to execute payroll"})}finally{o(!1)}}}return(0,d.useEffect)(()=>{t&&p()},[t,p]),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/50 p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Execute Payroll"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Active Employees"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-white mt-1",children:s})]}),(0,l.jsxs)("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Total Payrolls"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-white mt-1",children:i})]})]}),m?(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["This will process payroll for ",s," active employee",1!==s?"s":"",". Trust-gated routing will determine payment flows. Proceed?"]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{onClick:b,disabled:c,className:"flex-1 px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 text-white text-sm font-medium transition-colors",children:c?"Processing...":"Confirm Execute"}),(0,l.jsx)("button",{onClick:()=>x(!1),disabled:c,className:"px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 text-sm font-medium border border-slate-700 transition-colors",children:"Cancel"})]})]}):(0,l.jsx)("button",{onClick:()=>x(!0),disabled:!t||0===s,className:"w-full px-4 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:cursor-not-allowed text-white font-medium transition-colors",children:"Execute Payroll"}),u&&(0,l.jsx)("p",{className:"mt-3 text-sm ".concat("success"===u.type?"text-emerald-400":"text-red-400"),children:u.message})]})}var o=s(8705);function m(){let{payGramCore:e,contractsReady:t}=(0,a.$)(),[s,i]=(0,d.useState)([]),[n,c]=(0,d.useState)(!1),m=(0,d.useCallback)(async()=>{if(e){c(!0);try{let t=await e.nextPaymentId(),s=Number(t),l=[];for(let t=0;t<s&&t<50;t++)try{let s=await e.getPendingPayment(t);l.push({id:t,employee:s.employee,status:Number(s.status),createdAt:s.createdAt,releaseTime:s.releaseTime,milestone:s.milestone})}catch(e){}i(l.reverse())}catch(e){}finally{c(!1)}}},[e]);(0,d.useEffect)(()=>{t&&m()},[t,m]);let x=e=>{var t;return null!==(t=o.R$[e])&&void 0!==t?t:"Unknown"},u=e=>{switch(e){case 1:return"text-emerald-400 bg-emerald-900/50";case 2:return"text-yellow-400 bg-yellow-900/50";case 3:return"text-red-400 bg-red-900/50";case 4:return"text-blue-400 bg-blue-900/50";case 5:return"text-slate-400 bg-slate-800";default:return"text-slate-500 bg-slate-800"}};return(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/50 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Payment History"}),(0,l.jsx)("button",{onClick:m,disabled:n||!t,className:"px-3 py-1 rounded-lg bg-slate-800 hover:bg-slate-700 disabled:opacity-50 text-slate-300 text-xs font-medium border border-slate-700 transition-colors",children:n?"Loading...":"Refresh"})]}),t?0===s.length?(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No payments recorded yet"}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-left text-slate-500 border-b border-slate-800",children:[(0,l.jsx)("th",{className:"pb-3 font-medium",children:"ID"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Employee"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Status"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Created"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Release"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-800/50",children:s.map(e=>(0,l.jsxs)("tr",{className:"text-slate-300",children:[(0,l.jsxs)("td",{className:"py-3 font-mono text-xs",children:["#",e.id]}),(0,l.jsx)("td",{className:"py-3 font-mono text-xs",children:(0,r.FP)(e.employee)}),(0,l.jsx)("td",{className:"py-3",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(u(e.status)),children:x(e.status)})}),(0,l.jsx)("td",{className:"py-3 text-xs text-slate-400",children:(0,r.i$)(e.createdAt)}),(0,l.jsx)("td",{className:"py-3 text-xs text-slate-400",children:e.releaseTime>0n?(0,r.i$)(e.releaseTime):"â€”"})]},e.id))})]})}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Connect wallet to view payments"})]})}function x(){let{address:e,isConnected:t,chainName:s,isSupportedChain:d}=(0,a.$)();return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Employer Dashboard"}),(0,l.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Manage employees, execute payroll, and track payments"})]}),t&&(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Connected as"}),(0,l.jsx)("p",{className:"text-sm font-mono text-slate-300",children:(0,r.FP)(null!=e?e:"")}),s&&(0,l.jsx)("p",{className:"text-xs text-slate-500 mt-0.5",children:s})]})]}),t?d?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,l.jsx)(i,{}),(0,l.jsx)(c,{})]}),(0,l.jsx)(n,{}),(0,l.jsx)(m,{})]}):(0,l.jsx)("div",{className:"rounded-xl border border-red-900/50 bg-red-950/30 p-8 text-center",children:(0,l.jsx)("p",{className:"text-sm text-red-400",children:"Please switch to Sepolia or Ethereum Mainnet to use this dashboard."})}):(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/50 p-12 text-center",children:[(0,l.jsx)("svg",{className:"w-12 h-12 text-slate-600 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),(0,l.jsx)("h2",{className:"text-lg font-semibold text-white mb-2",children:"Connect Your Wallet"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Connect your wallet to access the employer dashboard"})]})]})}}},function(e){e.O(0,[288,478,971,117,744],function(){return e(e.s=4416)}),_N_E=e.O()}]);